<filter kube-127.var.log.containers**_ots-cashless-dev_**>
  @type record_transformer
  <record>
    fluentd_instance "#{Socket.gethostname}"
    beat.hostname fluentd
    tags ots-cashless-dev
  </record>
</filter>

<match kube-127.var.log.containers**_ots-cashless-dev_**>
    @type copy
    <store>
        @type kafka2
        brokers qa-itg-es-kafka-1.web.s7.ru:9092
        topic_key RAW_K8S_QA-127-LOGS_3.4.1_M1
        default_topic RAW_K8S_QA-127-LOGS_3.4.1_M1
        required_acks -1
        compression_codec gzip
        <buffer>
             flush_interval 3s
             @type file
             path /usr/share/fluentd/buffers-map/ots-cashless-dev
             flush_thread_count 4
             total_limit_size 2048M
             chunk_limit_size 64M
             chunk_limit_records 10000000
             queue_limit_length 200
        </buffer>
        <format>
            @type json
        </format>
    </store>
</match>

